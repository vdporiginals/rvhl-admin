<div class="box">
  <form [formGroup]="detailForm" (ngSubmit)="createOrUpdate()">
    <mat-card-content fxLayout="column" fxLayoutAlign="center">
      <div class="name_area" fxLayout="row" fxLayoutGap="10px">
        <div fxFlex="70" fxLayout="column">
          <div fxLayout="row" fxLayoutGap="10px">
            <mat-form-field class="name">
              <input
                matInput
                formControlName="title"
                color="warn"
                [placeholder]="
                  isEdit === true ? dataEdit.data.title : 'Thêm tên tour'
                "
              />
            </mat-form-field>
            <mat-form-field>
              <mat-label>Chọn loại tours</mat-label>
              <mat-select formControlName="category" required>
                <mat-option>--</mat-option>
                <mat-option
                  *ngFor="let category of categories"
                  [value]="category._id"
                >
                  {{ category.name }}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="detailForm.hasError('required')"
                >Please choose an category</mat-error
              >
            </mat-form-field>
          </div>

          <mat-form-field class="example-chip-list image">
            <mat-chip-list
              #chipList
              aria-label="img selection"
              formControlName="images"
            >
              <mat-chip
                *ngFor="let img of arrImage.value"
                [selectable]="selectable"
                [removable]="removable"
                (removed)="removeImg(img)"
              >
                {{ img | Overflow: ["5", "..."] }}
                <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
              </mat-chip>
              <input
                [placeholder]="
                  isEdit === true
                    ? (dataEdit.data.images | Overflow: ['10', '...'])
                    : 'Thêm ảnh'
                "
                [matChipInputFor]="chipList"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                [matChipInputAddOnBlur]="addOnBlur"
                (matChipInputTokenEnd)="addImg($event)"
              />
            </mat-chip-list>
          </mat-form-field>
        </div>
        <div fxFlex>
          <mat-form-field class="detail_full_width">
            <input
              OnlyNumber="true"
              class="price"
              matInput
              type="number"
              formControlName="price"
              [placeholder]="
                isEdit === true ? dataEdit.data.price : 'Thêm giá tour'
              "
            />
          </mat-form-field>
          <mat-form-field class="detail_full_width">
            <input
              OnlyNumber="true"
              matInput
              class="phone"
              type="text"
              formControlName="phone"
              [placeholder]="isEdit === true ? dataEdit.data.phone : 'Thêm sđt'"
            />
          </mat-form-field>
        </div>
      </div>
      <div class="body_area" fxLayout="row" fxLayoutGap="10px">
        <div fxFlex="50" fxLayout="column">
          <mat-form-field class="detail_full_width">
            <input
              matInput
              type="text"
              class="description"
              formControlName="description"
              [placeholder]="
                isEdit === true ? dataEdit.data.description : 'Thêm mô tả'
              "
            />
          </mat-form-field>
          <mat-form-field class="detail_full_width">
            <input
              matInput
              type="text"
              class="customer_num"
              formControlName="customerNum"
              [placeholder]="
                isEdit === true
                  ? dataEdit.data.customerNum
                  : 'Nhập số lượng khác / giá'
              "
            />
          </mat-form-field>
        </div>
        <div fxFlex="50" fxLayout="column">
          <mat-form-field class="detail_full_width">
            <input
              matInput
              type="text"
              class="address"
              formControlName="address"
              [placeholder]="
                isEdit === true ? dataEdit.data.address : 'Thêm địa chỉ'
              "
            />
          </mat-form-field>
          <mat-form-field class="detail_full_width">
            <input
              matInput
              type="text"
              class="time"
              formControlName="time"
              [placeholder]="
                isEdit === true ? dataEdit.data.time : 'Thêm thời gian tour'
              "
            />
          </mat-form-field>
        </div>
      </div>
      <div formArrayName="schedule">
        <div *ngFor="let child of formData.controls; let i = index">
          <h3>
            Dịch vụ thứ {{ i + 1 }}
            <button
              type="button"
              color="primary"
              mat-raised-button
              fxFlexOffset="15px"
              (click)="getFormSchedule()"
              fxFlex="20"
            >
              Thêm service
            </button>
          </h3>

          <div
            [formGroupName]="i"
            fxLayout="row"
            fxLayoutGap="10px"
            class="service_area"
          >
            <div fxFlex="50" fxLayout="column">
              <mat-form-field>
                <mat-label>chọn ngày bắt đầu</mat-label>
                <input
                  matInput
                  [placeholder]="
                    isEdit === true
                      ? (dataEdit.data.schedule.timeStart | date: 'medium')
                      : 'Thêm ngày bắt đầu dịch vụ'
                  "
                  formControlName="timeStart"
                  [matDatepicker]="timeStart"
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="timeStart"
                ></mat-datepicker-toggle>
                <mat-datepicker #timeStart></mat-datepicker>
              </mat-form-field>
              <mat-form-field class="detail_full_width">
                <mat-label>chọn ngày kết thúc</mat-label>
                <input
                  matInput
                  [placeholder]="
                    isEdit === true
                      ? (dataEdit.data.schedule.timeEnd | date: 'medium')
                      : 'Thêm ngày kết thúc dịch vụ'
                  "
                  formControlName="timeEnd"
                  [matDatepicker]="timeEnd"
                  color="warn"
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="timeEnd"
                ></mat-datepicker-toggle>
                <mat-datepicker #timeEnd></mat-datepicker>
              </mat-form-field>
            </div>
            <div fxFlex fxLayout="column">
              <mat-form-field class="detail_full_width">
                <mat-label>chọn địa điểm</mat-label>
                <input
                  matInput
                  [placeholder]="
                    isEdit === true
                      ? dataEdit.data.schedule.location
                      : 'Thêm địa điểm dịch vụ'
                  "
                  formControlName="location"
                  color="warn"
                />
              </mat-form-field>
              <mat-form-field class="detail_full_width">
                <mat-label>chọn dịch vụ</mat-label>
                <input
                  [placeholder]="
                    isEdit === true
                      ? dataEdit.data.schedule.service
                      : 'Thêm dịch vụ'
                  "
                  matInput
                  formControlName="service"
                  color="warn"
                />
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
    </mat-card-content>
    <mat-slide-toggle formControlName="status" [ngModel]="isEdit">
      Bật/tắt trạng thái</mat-slide-toggle
    >
    <button type="submit" mat-stroked-button color="warn" class="btn-block">
      Tạo tour
    </button>
  </form>
</div>
